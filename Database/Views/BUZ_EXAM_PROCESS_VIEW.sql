CREATE OR REPLACE FORCE VIEW BUZ_EXAM_PROCESS_VIEW AS
SELECT  case when HASH is not null and HASH=GenerateSHA1(ID||EXAM_ID||PROCESS_FLAG||PROCESS_TYPE||EXAM_ITEM||DEDUCT_ITEM||DEDUCT_SCORE||DEVICE_ID||SPEED||RECORD_TYPE||PROCESS_TIME||VIDEO_PATH||PROCESS_STATUS) then 'TRUE' else 'FALSE' end VERIFY,
        ID,
		EXAM_ID,
		(select SEQUENCENUMBER from BAS_BOOKING where ID=(select BOOKING_ID from BUZ_EXAM_INFO where ID=EXAM_ID)) BOOKING_SEQUENCENUMBER,
		(select NAME from BAS_STUDENT where ID=(select STUDENT_ID from BAS_BOOKING where ID=(select BOOKING_ID from BUZ_EXAM_INFO where ID=EXAM_ID))) STUDENT_NAME,
        (select STATUS from BAS_STUDENT where ID=(select STUDENT_ID from BAS_BOOKING where ID=(select BOOKING_ID from BUZ_EXAM_INFO where ID=EXAM_ID))) STUDENT_STATUS,
		(select DICT_NAME from CFG_DICT where DICT_TYPE=2001 and DICT_CODE=(select GENDER from BAS_STUDENT where ID=(select STUDENT_ID from BAS_BOOKING where ID=(select BOOKING_ID from BUZ_EXAM_INFO where ID=EXAM_ID)))) GENDER_DICT_NAME,
        (select IDNUMBER from BAS_STUDENT where ID=(select STUDENT_ID from BAS_BOOKING where ID=(select BOOKING_ID from BUZ_EXAM_INFO where ID=EXAM_ID))) STUDENT_IDNUMBER,
        (select DRIVER_LICENSE_TYPE from BAS_STUDENT where ID=(select STUDENT_ID from BAS_BOOKING where ID=(select BOOKING_ID from BUZ_EXAM_INFO where ID=EXAM_ID))) STUDENT_DRIVER_LICENSE_TYPE,
		(select DICT_NAME from CFG_DICT where DICT_TYPE=1007 and DICT_CODE=(select EXAM_REASON from BAS_BOOKING where ID=(select BOOKING_ID from BUZ_EXAM_INFO where ID=EXAM_ID))) EXAM_REASON,
		(select NAME from BAS_EXAMINER where ID=(select EXAMINER1_ID from BAS_BOOKING where ID=(select BOOKING_ID from BUZ_EXAM_INFO where ID=EXAM_ID))) EXAMINER1_NAME,
		(select NAME from BAS_EXAMINER where ID=(select EXAMINER2_ID from BAS_BOOKING where ID=(select BOOKING_ID from BUZ_EXAM_INFO where ID=EXAM_ID))) EXAMINER2_NAME,
        (select SEQUENCENUMBER from BAS_CAR where ID=(select CAR_ID from BAS_BOOKING where ID=(select BOOKING_ID from BUZ_EXAM_INFO where ID=EXAM_ID))) CARSEQUENCENUMBER,
		(select DICT_NAME from CFG_DICT where DICT_TYPE=2004 and DICT_CODE=(select CAR_TYPE from BAS_CAR where ID=(select CAR_ID from BAS_BOOKING where ID=(select BOOKING_ID from BUZ_EXAM_INFO where ID=EXAM_ID)))) CAR_TYPE,
        (select CARNUMBER from BAS_CAR where ID=(select CAR_ID from BAS_BOOKING where ID=(select BOOKING_ID from BUZ_EXAM_INFO where ID=EXAM_ID))) CARNUMBER,
        (select LICENSE_PLATE from BAS_CAR where ID=(select CAR_ID from BAS_BOOKING where ID=(select BOOKING_ID from BUZ_EXAM_INFO where ID=EXAM_ID))) CAR_LICENSE_NUMBER,
        (select BRAND from BAS_CAR where ID=(select CAR_ID from BAS_BOOKING where ID=(select BOOKING_ID from BUZ_EXAM_INFO where ID=EXAM_ID)))CAR_BRAND,
		(select NAME from BAS_DRIVING_SCHOOL where ID=(select SCHOOL_ID from BAS_BOOKING where ID=(select BOOKING_ID from BUZ_EXAM_INFO where ID=EXAM_ID))) SCHOOL_NAME,
        (select DICT_NAME from CFG_DICT where DICT_TYPE=1006 and DICT_CODE=(select SUBJECT from BUZ_EXAM_INFO where ID=EXAM_ID)) SUBJECT_DICT_NAME,
		(select DICT_NAME from CFG_DICT where DICT_TYPE=1008 and DICT_CODE=(select EXAM_STATUS from BUZ_EXAM_INFO where ID=EXAM_ID)) EXAM_STATUS_DICT_NAME,
		(select SEQUENCENUMBER from BAS_DEVICE where ID=DEVICE_ID) DEVICE_SEQUENCENUMBER,
		(select DEVICENUMBER from BAS_DEVICE where ID=DEVICE_ID) DEVICE_NUMBER,
		PROCESS_TIME,
        (select DICT_NAME from CFG_DICT where DICT_TYPE=1024 and DICT_CODE=PROCESS_FLAG) PROCESS_FLAG_DICT_NAME,
        (select DICT_NAME from CFG_DICT where DICT_TYPE=1025 and DICT_CODE=PROCESS_TYPE) PROCESS_TYPE_DICT_NAME,
		EXAM_ITEM,
		case when EXAM_ITEM is null then null else (select ITEM_NAME from CFG_ITEMS where ITEM_CODE=EXAM_ITEM) end EXAM_ITEM_NAME,
		DEDUCT_ITEM,
		case when DEDUCT_ITEM is null then null else (select DEDUCT_SCORE from CFG_ITEMS where ITEM_CODE=DEDUCT_ITEM) end DEDUCT_SCORE,
		case when DEDUCT_ITEM is null then null else (select ITEM_NAME from CFG_ITEMS where ITEM_CODE=DEDUCT_ITEM) end DEDUCT_ITEM_NAME,
		PROCESS_PHOTO
FROM BUZ_EXAM_PROCESS
ORDER BY ID;